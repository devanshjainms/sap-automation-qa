enums:
  severity:
    - info:                           &info "INFO"
    - high:                           &high "HIGH"
    - low:                            &low "LOW"
    - warning:                        &warning "WARNING"
    - critical:                       &critical "CRITICAL"
    - all_severity:                   &severity [*info, *high, *low, *warning, *critical]

  os_type:
    - suse:                           &suse "SLES_SAP"
    - redhat:                         &redhat "REDHAT"
    - oraclelinux:                    &oraclelinux "OracleLinux"
    - windows:                        &windows "Windows"
    - all_os:                         &os_type [*suse, *redhat, *oraclelinux, *windows]

  os_version:
    - suse_12_3:                      &suse_12_3 "SUSE 12 SP3"
    - suse_12_4:                      &suse_12_4 "SUSE 12 SP4"
    - suse_12_5:                      &suse_12_5 "SUSE 12 SP5"
    - suse_15_0:                      &suse_15_0 "SUSE 15 SP0"
    - suse_15_1:                      &suse_15_1 "SUSE 15 SP1"
    - all_versions:                   &all_versions "all"

  hardware_type:
    - vm:                             &vm "VM"
    - hli:                            &hli "HLI"
    - all_hardware:                   &all_hardware [*vm, *hli]

  storage_type:
    premium_storage:                  &premium_storage ["Premium_LRS","UltraSSD_LRS","PremiumV2_LRS","AFS"]
    anf:                              &anf ["ANF"]
    all_storage:                      &all_storage ["Premium_LRS","UltraSSD_LRS","StandardSSD_LRS","Standard_LRS","ANF","PremiumV2_LRS","AFS"]

  workload:
    - sap:                            &sap "SAP"
    - all_workload:                   &workload [*sap]

  db:
    - hana:                           &hana "HANA"
    - mssql:                          &mssql "MSSQL"
    - oracle:                         &oracle "Oracle"
    - db2:                            &db2 "Db2"
    - ase:                            &ase "ASE"
    - all_db:                         &db [*hana, *mssql, *oracle, *db2, *ase]

  role:
    - db:                             &db_role "DB"
    - ascs:                           &ascs_role "SCS"
    - ers:                            &ers_role "ERS"
    - app:                            &app_role "APP"
    - webdispatcher:                  &web_dispatch "WEB"
    - pas:                            &pas "PAS"
    - all_role:                       &all_role [*db_role, *ascs_role, *ers_role, *app_role, *web_dispatch, *pas]

  cluster_type:
    - sbd:                            &sbd "ISCSI"
    - fencing_agent:                  &fencing_agent "AFA"
    - all_fencing_agent:              &cluster_type [*sbd, *fencing_agent]

  collector_type:
    - command:                        &command "command"
    - azure:                          &azure "azure"
    - all_collector_type:             &collector_type [*command, *azure]

  category:
    - package:                        &package_check "Package"
    - vm:                             &vm_check "Virtual Machine"
    - sap:                            &sap_check "SAP"
    - os:                             &os_check "Operating System"
    - all_check_types:                &category [*package_check, *vm_check, *sap_check, *os_check]

  user:
    - root:                           &root "root"
    - sidadm:                         &sidadm "sidadm"
    - db2sid:                         &db2sid "db2sid"
    - all_users:                      &user [*root, *sidadm, *db2sid]

  validator_type:
    - string:                         &string "string"
    - range:                          &range "range"
    - list:                           &list "list"
    - all:                            &validator_type [*string, *range, *list]

  report:
    - check:                          &check "check"
    - section:                        &section "section"
    - table:                          &table "table"
    - report:                         &report [*check, *section, *table]

# Checks for DB roles for database_type == hana

checks:
  - id:                                 "DB-Db2-0001"
    name:                               "Db2 Hardware Check"
    description:                        "Check if the hardware type is supported for Db2"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             *all_role
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          "lscpu | grep -E 'Architecture:|Vendor ID:|Model name:' | grep 'x86_64' | awk '{print $2}'"
      user:                             *root
    validator_type:                     *list
    validator_args:
      valid_list:                       ["x86_64", "x64"]
    report:                             *check

  - id:                                 "DB-Db2-0002"
    name:                               "Linux installation & system language"
    description:                        "Check if the Linux installation and system language are supported for Db2"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             *all_role
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          "echo $LANG"
      user:                             *db2sid
    validator_type:                     *string
    validator_args:
      expected_output:                  "en_US.UTF-8"
    report:                             *check

  - id:                                 "DB-Db2-0003"
    name:                               "SELinux settings"
    description:                        "SAP recommended SELinux in permissive mode or disabled"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             *all_role
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          "[ -f /etc/selinux/config ] && grep '^SELINUX=' /etc/selinux/config | awk -F= '{print $2}' || echo 'disabled'"
      user:                             *root
    validator_type:                     *list
    validator_args:
      valid_list:                       ["permissive", "disabled"]
    report:                             *check
    references:
      sap:                              "2936683"

  - id:                                 "DB-Db2-0004"
    name:                               "vm.max_map_count should be MemTotal/4096"
    description:                        "vm.max_map_count setting should be set to MemTotal/4096"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             *all_role
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          "max_map_count=$(/sbin/sysctl vm.max_map_count -n); mem_bytes=$(free -b | grep Mem: | awk '{print $2}'); required=$((mem_bytes / 4096)); [ $max_map_count -eq $required ] && echo OK || echo \"vm.max_map_count=$max_map_count (required: $required [MemTotal/4096])\""
      user:                             *root
    validator_type:                     *string
    validator_args:
      expected_output:                  "OK"
    report:                             *check

  - id:                                 "DB-Db2-0005"
    name:                               "VM Swappiness setting"
    description:                        "vm.swappiness setting"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             *all_role
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          "/sbin/sysctl vm.swappiness -n"
      user:                             *root
    validator_type:                     *string
    validator_args:
      expected_output:                  "5"
    report:                             *check
    references:
      sap:                              "2936683"

  - id:                                 "DB-Db2-0006"
    name:                               "VM Overcommit recovery setting"
    description:                        "vm.overcommit_memory setting"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             *all_role
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          "/sbin/sysctl vm.overcommit_memory -n"
      user:                             *root
    validator_type:                     *string
    validator_args:
      expected_output:                  "0"
    report:                             *check

  - id:                                 "DB-Db2-0007"
    name:                               "Randomize VA Space setting"
    description:                        "Randomize VA Space"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             *all_role
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          "/sbin/sysctl kernel.randomize_va_space -n"
      user:                             *root
    validator_type:                     *string
    validator_args:
      expected_output:                  "5"
    report:                             *check

  - id:                                 "DB-Db2-0008"
    name:                               "Max Async I/O"
    description:                        "Max Async I/O setting"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             *all_role
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          "/sbin/sysctl fs.aio-max-nr -n"
      user:                             *root
    validator_type:                     *string
    validator_args:
      expected_output:                  "1048576"
    report:                             *check
    references:
      sap:                              "2936683"

  - id:                                 "DB-Db2-0009"
    name:                               "kernel.sem (SEMMSL)"
    description:                        "kernel.sem SEMMSL (first value) should be at least 250"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             *all_role
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          "semmsl=$(/sbin/sysctl kernel.sem -n | awk '{print $1}'); [ $semmsl -ge 250 ] && echo OK || echo \"SEMMSL=$semmsl (required: >= 250)\""
      user:                             *root
    validator_type:                     *string
    validator_args:
      expected_output:                  "OK"
    report:                             *check
    references:
      other:                            "https://www.ibm.com/docs/en/db2/11.1?topic=unix-kernel-parameter-requirements-linux"

  - id:                                 "DB-Db2-0009a"
    name:                               "kernel.sem (SEMMNS)"
    description:                        "kernel.sem SEMMNS (second value) should be at least SEMMNI or 256000, whichever is greater"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             *all_role
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          "sem_values=$(/sbin/sysctl kernel.sem -n); semmns=$(echo $sem_values | awk '{print $2}'); semmni=$(echo $sem_values | awk '{print $4}'); min_required=$([ $semmni -gt 256000 ] && echo $semmni || echo 256000); [ $semmns -ge $min_required ] && echo OK || echo \"SEMMNS=$semmns (required: >= $min_required [max of SEMMNI=$semmni or 256000])\""
      user:                             *root
    validator_type:                     *string
    validator_args:
      expected_output:                  "OK"
    report:                             *check
    references:
      other:                            "https://www.ibm.com/docs/en/db2/11.1?topic=unix-kernel-parameter-requirements-linux"

  - id:                                 "DB-Db2-0009b"
    name:                               "kernel.sem (SEMOPM)"
    description:                        "kernel.sem SEMOPM (third value) should be at least 32"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             *all_role
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          "semopm=$(/sbin/sysctl kernel.sem -n | awk '{print $3}'); [ $semopm -ge 32 ] && echo OK || echo \"SEMOPM=$semopm (required: >= 32)\""
      user:                             *root
    validator_type:                     *string
    validator_args:
      expected_output:                  "OK"
    report:                             *check
    references:
      other:                            "https://www.ibm.com/docs/en/db2/11.1?topic=unix-kernel-parameter-requirements-linux"

  - id:                                 "DB-Db2-0009c"
    name:                               "kernel.sem (SEMMNI)"
    description:                        "kernel.sem SEMMNI (fourth value) should be at least 256 times the total physical memory in GB"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             *all_role
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          "semmni=$(/sbin/sysctl kernel.sem -n | awk '{print $4}'); mem_gb=$(free -g | grep Mem: | awk '{print $2}'); min_required=$((256 * mem_gb)); [ $semmni -ge $min_required ] && echo OK || echo \"SEMMNI=$semmni (required: >= $min_required [256 * ${mem_gb}GB RAM])\""
      user:                             *root
    validator_type:                     *string
    validator_args:
      expected_output:                  "OK"
    report:                             *check
    references:
      other:                            "https://www.ibm.com/docs/en/db2/11.1?topic=unix-kernel-parameter-requirements-linux"

  - id:                                 "DB-Db2-0010"
    name:                               "Kernel out of process"
    description:                        "Parameter that controls the system's behavior in response to a kernel out of process [OOPS]."
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             *all_role
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          "/sbin/sysctl kernel.panic_on_oops -n"
      user:                             *root
    validator_type:                     *list
    validator_args:
      valid_list:                       ["0", "1", "2"]
    report:                             *check
    references:
      other:                            "https://www.ibm.com/docs/en/db2/11.1?topic=unix-kernel-parameter-requirements-linux"

  - id:                                 "DB-Db2-0011"
    name:                               "Max File Handles"
    description:                        "Parameter sets the maximum number of file handles (file descriptors) that the kernel will allocate."
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             *all_role
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          "/sbin/sysctl fs.file-max -n"
      user:                             *root
    validator_type:                     *range
    validator_args:
      min:                              16384
    report:                             *check
    references:
      other:                            "https://www.ibm.com/docs/en/db2/11.1?topic=unix-kernel-parameter-requirements-linux"

  - id:                                 "DB-Db2-0012"
    name:                               "Transparent Huge Pages"
    description:                        "Transparent Huge Pages (THP) is a Linux kernel feature related to memory management."
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             *all_role
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          "cat /sys/kernel/mm/transparent_hugepage/enabled"
      user:                             *root
    validator_type:                     *string
    validator_args:
      expected_output:                  "always madvise [never]"
    report:                             *check
    references:
      sap:                              "2391706"
      other:                            "https://www.ibm.com/docs/en/db2/11.1?topic=unix-kernel-parameter-requirements-linux"

  - id:                                 "DB-Db2-0013"
    name:                               "HADR TIMEOUT"
    description:                        "HADR TIMEOUT should be 45 seconds for RHEL"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *premium_storage
      role:                             [*db_role]
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          ". ~/sqllib/db2profile && db2pd -alldbs -hadr | grep -i 'HADR_TIMEOUT' | awk '{print $NF}'"
      user:                             *db2sid
    validator_type:                     *string
    validator_args:
      expected_output:                  "45"
    report:                             *check
    references:
      microsoft:                        "https://learn.microsoft.com/en-us/azure/sap/workloads/high-availability-guide-rhel-ibm-db2-luw?tabs=lb-portal#ibm-db2-hadr-settings-for-azure"

  - id:                                 "DB-Db2-0014"
    name:                               "HADR TIMEOUT"
    description:                        "HADR TIMEOUT should be 60 seconds for SUSE"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *premium_storage
      role:                             [*db_role]
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          ". ~/sqllib/db2profile && db2pd -alldbs -hadr | grep -i 'HADR_TIMEOUT' | awk '{print $NF}'"
      user:                             *db2sid
    validator_type:                     *string
    validator_args:
      expected_output:                  "60"
    report:                             *check
    references:
      microsoft:                        "https://learn.microsoft.com/en-us/azure/sap/workloads/high-availability-guide-rhel-ibm-db2-luw?tabs=lb-portal#ibm-db2-hadr-settings-for-azure"

  - id:                                 "DB-Db2-0015"
    name:                               "PEER WINDOW (seconds)"
    description:                        "PEER WINDOW should be 240 seconds for RHEL"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *premium_storage
      role:                             [*db_role]
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          ". ~/sqllib/db2profile && db2pd -alldbs -hadr | grep -i 'PEER_WINDOW(seconds)' | awk '{print $NF}'"
      user:                             *db2sid
    validator_type:                     *string
    validator_args:
      expected_output:                  "240"
    report:                             *check
    references:
      microsoft:                        "https://learn.microsoft.com/en-us/azure/sap/workloads/high-availability-guide-rhel-ibm-db2-luw?tabs=lb-portal#ibm-db2-hadr-settings-for-azure"

  - id:                                 "DB-Db2-0016"
    name:                               "PEER WINDOW (seconds)"
    description:                        "PEER WINDOW should be 300 seconds for SUSE with SBD"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *premium_storage
      role:                             [*db_role]
      database_type:                    [*db2]
      high_availability_agent:          *sbd
    collector_type:                     *command
    collector_args:
      command:                          ". ~/sqllib/db2profile && db2pd -alldbs -hadr | grep -i 'PEER_WINDOW(seconds)' | awk '{print $NF}'"
      user:                             *db2sid
    validator_type:                     *string
    validator_args:
      expected_output:                  "300"
    report:                             *check
    references:
      microsoft:                        "https://learn.microsoft.com/en-us/azure/sap/workloads/high-availability-guide-rhel-ibm-db2-luw?tabs=lb-portal#ibm-db2-hadr-settings-for-azure"

  - id:                                 "DB-Db2-0017"
    name:                               "PEER WINDOW (seconds)"
    description:                        "PEER WINDOW should be 900 seconds for SUSE with Fencing Agent"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *premium_storage
      role:                             [*db_role]
      database_type:                    [*db2]
      high_availability_agent:          *fencing_agent
    collector_type:                     *command
    collector_args:
      command:                          ". ~/sqllib/db2profile && db2pd -alldbs -hadr | grep -i 'PEER_WINDOW(seconds)' | awk '{print $NF}'"
      user:                             *db2sid
    validator_type:                     *string
    validator_args:
      expected_output:                  "900"
    report:                             *check
    references:
      microsoft:                        "https://learn.microsoft.com/en-us/azure/sap/workloads/high-availability-guide-rhel-ibm-db2-luw?tabs=lb-portal#ibm-db2-hadr-settings-for-azure"

  - id:                                 "DB-Db2-0018"
    name:                               "Maximum shared memory segments"
    description:                        "Maximum shared memory segments should be at least 256 times the total physical memory in GB"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             [*db_role]
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          "shmmni=$(/sbin/sysctl kernel.shmmni -n); mem_gb=$(free -g | grep Mem: | awk '{print $2}'); min_required=$((256 * mem_gb)); [ $shmmni -ge $min_required ] && echo OK || echo \"kernel.shmmni=$shmmni (required: >= $min_required, memory: ${mem_gb}GB)\""
      user:                             *root
    validator_type:                     *string
    validator_args:
      expected_output:                  "OK"
    report:                             *check
    references:
      other:                            "https://www.ibm.com/docs/en/db2/11.1?topic=unix-kernel-parameter-requirements-linux"
      sap:                              "2751102"

  - id:                                 "DB-Db2-0019"
    name:                               "Instance Memory size"
    description:                        "Instance Memory size should be at least 64 GB"
    category:                           *sap_check
    severity:                           *high
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *premium_storage
      role:                             [*db_role]
      database_type:                    [*db2]
    collector_type:                     *command
    collector_args:
      command:                          ". ~/sqllib/db2profile && db2pd -dbmcfg | grep INSTANCE_MEMORY | awk \"{if(\\$NF<=100) print \\$NF; else print \\$NF*4096/1024/1024/1024}\""
      user:                             *db2sid
    validator_type:                     *range
    validator_args:
      min:                              64
    report:                             *check
    references:
      sap:                              "2751102"

  - id:                                 "DB-Db2-0020"
    name:                               "Filesystem Mount Points"
    description:                        "Displays all filesystem mount points on the Db2 system"
    category:                           *sap_check
    severity:                           *info
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             [*db_role]
      database_type:                    [*db2]
    collector_type:                     *azure
    collector_args:
      resource_type:                    "filesystem"
    report:                             *table
    references:
      microsoft:                        "https://learn.microsoft.com/azure/virtual-machines/workloads/sap/dbms-guide-ibm"

  - id:                                 "DB-Db2-0021"
    name:                               "Azure Disks"
    description:                        "Displays Azure disk configuration for the Db2 system"
    category:                           *sap_check
    severity:                           *info
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             [*db_role]
      database_type:                    [*db2]
    collector_type:                     *azure
    collector_args:
      resource_type:                    "disk"
    report:                             *table
    references:
      microsoft:                        "https://learn.microsoft.com/azure/virtual-machines/workloads/sap/dbms-guide-ibm"

  - id:                                 "DB-Db2-0022"
    name:                               "LVM Groups"
    description:                        "Lists all LVM groups to ensure SAP HANA directories are configured with supported LVM configurations."
    category:                           *sap_check
    severity:                           *info
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             [*db_role]
      database_type:                    [*db2]
    collector_type:                     *azure
    collector_args:
      resource_type:                    "lvm_groups"
    report:                             *table
    references:
      sap:                              "2972496"
      microsoft:                        "https://docs.microsoft.com/en-us/azure/virtual-machines/workloads/sap/hana-vm-operations-storage"

  - id:                                 "DB-Db2-0023"
    name:                               "LVM Volumes"
    description:                        "Lists all LVM volumes to ensure SAP HANA directories are configured with supported LVM configurations."
    category:                           *sap_check
    severity:                           *info
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             [*db_role]
      database_type:                    [*db2]
    collector_type:                     *azure
    collector_args:
      resource_type:                    "lvm_volumes"
    report:                             *table
    references:
      sap:                              "2972496"
      microsoft:                        "https://docs.microsoft.com/en-us/azure/virtual-machines/workloads/sap/hana-vm-operations-storage"

  - id:                                 "DB-Db2-0024"
    name:                               "ANF Volumes"
    description:                        "Lists all ANF volumes to ensure SAP HANA directories are configured with supported ANF configurations."
    category:                           *sap_check
    severity:                           *info
    workload:                           *sap
    applicability:
      os_type:                          [*suse, *redhat]
      os_version:                       *all_versions
      hardware_type:                    *vm
      storage_type:                     *all_storage
      role:                             [*db_role]
      database_type:                    [*db2]
    collector_type:                     *azure
    collector_args:
      resource_type:                    "anf_volumes"
    report:                             *table
    references:
      sap:                              "2972496"
      microsoft:                        "https://docs.microsoft.com/en-us/azure/virtual-machines/workloads/sap/hana-vm-operations-storage"
